#include "common_options.txt"
.TH GRDVOLUME 1 MANDATE GMT_STRING "Generic Mapping Tools"
.SH NAME
grdvolume \- Calculating volume under a surface within a contour
.SH SYNOPSIS
\fBgrdvolume\fP \fIgrdfile\fP [ OPT(C)\fIcval\fP or OPT(C)\fIlow/high/delta\fP ] 
[ OPT(L)\fIbase\fP ] [ GMT_Rgeo_OPT ] [ OPT(S)[\fBk\fP] ] [ OPT(T) ] [ GMT_V_OPT[\fBl\fP] ] 
[ OPT(Z)\fIfact\fP[/\fIdelta\fP] ] [ GMT_fi_OPT ]
.SH DESCRIPTION
\fBgrdvolume\fP reads a 2-D binary grid file and calculates the volume contained
between the surface and the plane specified by the given contour (or zero if not given)
and reports the area, volume, and maximum mean height (volume/area).
Alternatively, specify a range of contours to be tried and \fBgrdvolume\fP will determine
the volume and area inside the contour for all contour values.  The contour that produced
the maximum mean height is reported as well.  This feature may be used with
\fBgrdfilter\fP in designing an Optimal Robust Separator [\fIWessel\fP, 1998].
.TP
\fIgrdfile\fP
The name of the input 2-D binary grid file.
(See GRID FILE FORMAT below.)
.SH OPTIONS
No space between the option flag and the associated arguments.
.TP
OPT(C)
find area and volume inside the \fIcval\fP contour.  Alternatively, search using
all contours from \fIlow\fP to \fIhigh\fP in steps of \fIdelta\fP.  [Default returns
entire area and volume of grid].  The area is measured in the plane of the contour.
.TP
OPT(L)
Also add in the volume from the level of the contour down to \fIbase\fP [Default base is contour].
.TP
OPT(S)
Convert degrees to meters, append \fBk\fP for km [Default is Cartesian].
.TP
OPT(T)
Use curvature minimum rather than maximum height to find best contour value (when contour
search is selected with OPT(C)).
#include "explain_-R.txt"
#include "explain_-V.txt"
Append \fBl\fP to see all the results for each contour level tested (when contour search
has been selected).
.TP
OPT(Z)
Optionally subtract \fIshift\fP before scaling data by \fIfact\fP. [Default is no scaling].
(Numbers in OPT(C), OPT(L) refer to values after this scaling has occurred).
#include "explain_-f.txt"
#include "explain_grd_input.txt"
.SH EXAMPLES
To determine the volume in km^3 under the surface hawaii_topo.grd (height in km), use
.br
.sp
\fBgrdvolume\fP hawaii_topo.grd OPT(Sk)
.br
.sp
To find the volume between the surface peaks.grd and the contour z = 250, use
.br
.sp
\fBgrdvolume\fP peaks.grd OPT(Sk) OPT(C)250
.br
.sp
To search for the contour, between 100 and 300 in steps of 10, that maximizes the ratio of volume
to surface area for the file peaks.grd, use
.br
.sp
\fBgrdvolume\fP peaks.grd OPT(Sk) OPT(C)100/300/10 > results.d
.br
.sp
To see the areas and volumes for all the contours in the previous example, use
.br
.sp
\fBgrdvolume\fP peaks.grd OPT(Sk) OPT(Vl) OPT(C)100/300/10 > results.d
.SH "NOTES"
\fBgrdvolume\fP distinguishes between gridline and gridcell oriented grids. In both cases the area and
volume are computed up to the grid boundaries. That means that in the first case the gridcells on
the boundary only contribute half their area (and volume), whereas in the second case all gridcells
are fully used. The exception is when the OPT(C) flag is used: since contours do not extend beyond
the outermost gridpoint, both grid types are treated the same. That means the outer rim in gridcell
oriented grids is ignored when using the OPT(C) flag.
.SH "SEE ALSO"
.IR GMT (1),
.IR grdfilter (1)
.SH REFERENCES
Wessel, P., 1998, An empirical method for optimal robust regional-residual separation of geophysical data,
\fIMath. Geol., 30(4)\fP, 391\-408.
