#include "common_options.txt"
.TH PSCOUPE 1 MANDATE GMT_STRING "Generic Mapping Tools"   
.SH NAME
pscoupe \- Plot cross-sections of focal mechanisms. 
.SH SYNOPSIS
.br
\fBpscoupe\fP \fIfiles\fP GMT_J_OPT GMT_Rgeo_OPT
OPT(A)\fIparameters\fP [ GMT_B_OPT ]  [ OPT(F)\fIfill\fP ]
[ OPT(G)\fIfill\fP ] [ GMT_H_OPT ]
[ GMT_K_OPT ] [ OPT(L)\fI[pen]\fP ] [ OPT(M) ] [ OPT(N) ] [ GMT_O_OPT ] 
[ GMT_P_OPT ] [ OPT(S)\fI<symbol><scale>\fP[/\fBd\fP] ]
[ OPT(s)\fI<symbol><size>\fP[/\fBd\fP] ] [ OPT(T)\fIn\fP ] [ GMT_U_OPT ]
[ GMT_V_OPT ] [ OPT(W)\fIpen\fP ] [ GMT_X_OPT ]
[ GMT_Y_OPT ] [ OPT(Z)\fIcpt\fP ]
[ OPT(a)[\fIsize\fP/[\fIP_symbol\fP/[\fIT_symbol\fP]]] ]
[ OPT(g)\fIfill\fP ] [ OPT(e)\fIfill\fP ] [ OPT(p)\fIpen\fP ]
[ OPT(t)\fIpen\fP ] [ GMT_t_OPT ] [ GMT_c_OPT ]
.SH DESCRIPTION
.br
\fBpscoupe\fP reads data values from \fIfiles\fP [or standard input] and
generates \fIPostScript\fP code that will plot symbols, lines or polygons on a cross-section.
Focal mechanisms  may be specified and require additional columns of data.
The \fIPostScript\fP code is written to standard output. 
.sp
\fIfiles\fP list one or more file-names. If no files are given, \fBpscoupe\fP
will read standard input.
.sp
A \fInew file\fP is created with the new coordinates (\fBx\fP, \fBy\fP) and the
mechanism (from lower focal half-sphere for horizontal plane, to half-sphere
behind a vertical plane).
When the plane is not horizontal,
- north direction becomes upwards steepest descent direction of the plane (u)
- east direction becomes strike direction of the plane (s)
- down direction (= north^east) becomes u^s
.br
Axis angles are defined in the same way as in horizontal plane in the new system.
.br
Moment tensor (initially in r, t, f system that is up, south, east)
is defined in (-u^s, -u, s) system.
A \fI file\fP  is created with extracted events.
.sp 
#include "explain_-J_short.txt"
#include "explain_-Rgeo.txt"
If frame is defined from cross-section parameters (see \fB-A\fP) this option is not taken into account,
but must be present.
.TP
OPT(A)  selects the cross-section.
.br
OPT(Aa)\fIlon1/lat1/lon2/lat2/dip/p_width/dmin/dmax\fP[\fBf\fP]
.br
\fIlon\fP and \fIlat\fP are the longitude and latitude of points 1 and 2 limiting the length of the cross-section.
.br
\fIdip\fP is the dip of the plane on which the cross-section is made.
.br
\fIp_width\fP is the width of the cross-section on each side of a vertical plane
or above and under an oblique plane. 
.br
\fIdmin\fP and \fIdmax\fP are the distances min and max from horizontal plane, 
along steepest descent direction.
.br
Add \fBf\fP to get the frame from the cross-section parameters.
.br
OPT(Ab)\fIlon1/lat1/strike/p_length/dip/p_width/dmin/dmax\fP[\fBf\fP]
.br
\fIlon1\fP and \fIlat1\fP are the longitude and latitude of the beginning of the cross-section.
.br
\fIstrike\fP is the azimuth of the direction of the cross-section.
.br
\fIp_length\fP is the length along which the cross-section is made.
.br
The other parameters are the same as for \fB-Aa\fP option.
.br
\fP\-Ac\fP\fIx1/y1/x2/y2/dip/p_width/dmin/dmax\fP[\fBf\fP]
.br
The same as OPT(Aa) option with \fIx\fP and \fIy\fP cartesian coordinates.
.br
OPT(Ad)\fIx1/y1/strike/p_length/dip/p_width/dmin/dmax\fP[\fBf\fP]
.br
The same as OPT(Ab) option with \fIx\fP and \fIy\fP cartesian coordinates.
.br
.TP
OPT(S)
selects the meaning of the columns in the data file and the figure to be plotted.
.TP
OPT(Sa)\fIscale[/fontsize[/offset\fP[\fBu\fP]]]
Focal mechanisms in Aki and Richard convention.
\fIscale\fP adjusts the scaling of the radius of the "beach ball",
which will be proportional to the magnitude.  The \fIscale\fP is the size for
magnitude = 5 in \fBMEASURE_UNIT\fP (unless \fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is
appended to indicate that the size information is in units of cm, inches,
meters, or points, respectively).  Use the OPT(T) option
to render the beach ball transparent by drawing only the nodal planes
and the circumference.  The color or shade of the compressive
quadrants can be specified with the OPT(G) option.  The color or shade
of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.sp
.IP \fB1,2\fP:
longitude, latitude of event (OPT(:) option interchanges order)
.IP \fB3\fP:
depth of event in kilometers
.IP \fB4,5,6\fP:
strike, dip and rake
.IP \fB7\fP:
magnitude
.IP \fB8,9\fP:
not used; can be 0 0; allows use of the psmeca file format
.IP \fB10\fP:
text string to appear above the beach ball (default) or under (add \fBu\fP).
.sp
.TP
OPT(Sc)scale\fP
Focal mechanisms in Harvard CMT convention.  
\fIscale\fP adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude. The \fIscale\fP is the size for magnitude = 5
(that is M0 = 4E+23 dynes-cm.) in \fBMEASURE_UNIT\fP (unless \fBc\fP, \fBi\fP,
\fBm\fP, or \fBp\fP is appended to indicate that the size information is in
units of cm, inches, meters, or points, respectively).  Use the OPT(T) option
to render the beach ball transparent by drawing only the nodal planes
and the circumference. The color or shade of the compressive quadrants
can be specified with the OPT(G) option.  The color or shade
of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.IP \fB1,2\fP:
longitude, latitude of event (OPT(:) option interchanges order)
.IP \fB3\fP:
depth of event in kilometers
.IP \fB4,5,6\fP:
strike, dip, and slip of plane 1
.IP \fB7,8,9\fP:
strike, dip, and slip of plane 2
.IP \fB10,11\fP:
mantissa and exponent of moment in dyne-cm (if magnitude is uses instead of scalar moment, magnitude is in column 10 and 0 must be in column 11)
.IP \fB12,13\fP:
not used; can be 0 0; allows use of the psmeca file format
.IP \fB14\fP:
text string to appear above the beach ball (default) or under (add \fBu\fP).
.sp
.TP
OPT(Sp)\fIscale[/fontsize[/offset\fP[\fBu\fP]]]
Focal mechanisms given with partial data on both planes.
\fIscale\fP adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude.  The \fIscale\fP is the size for magnitude
= 5 in \fBMEASURE_UNIT\fP (unless \fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is appended
to indicate that the size information is in units of cm, inches, meters, or
points, respectively).  The color or shade of the compressive quadrants
can be specified with the OPT(G) option.  The color or shade of the extensive
quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.IP \fB1,2\fP:
longitude, latitude of event (OPT(:) option interchanges order)
.IP \fB3\fP:
depth
.IP \fB4,5\fP:
strike, dip of plane 1
.IP \fB6\fP:
strike of plane 2
.IP \fB7\fP:
must be -1/+1 for a normal/inverse fault
.IP \fB8\fP:
magnitude
.IP \fB9,10\fP:
not used; can be 0 0; allows use of the psmeca file format
.IP \fB11\fP:
text string to appear above the beach ball (default) or under (add \fBu\fP).
.sp
.TP
OPT(Sm)\fIscale[/fontsize[/offset\fP[\fBu\fP]]]
Seismic moment tensor.
\fIscale\fP adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude. The \fIscale\fP is the size for magnitude = 5
(that is seismic scalar moment = 4E+23 dynes-cm) in \fBMEASURE_UNIT\fP (unless
\fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is appended to indicate that the size
information is in units of cm, inches, meters, or points, respectively).
(OPT(T)\fI0\fP option overlays best double couple transparently.) Put
OPT(Sd)\fIscale[/fontsize[/offset\fP[\fBu\fP]]] to plot the only double couple part
of moment tensor.  Put OPT(Sz)\fIscale[/fontsize[/offset\fP[\fBu\fP]]] to plot
anisotropic part of moment tensor (zero trace).  The color or shade of the
compressive quadrants can be specified with the OPT(G) option.  The color or
shade of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.IP \fB1,2\fP:
longitude, latitude of event (OPT(:) option interchanges order)
.IP \fB3\fP:
depth of event in kilometers
.IP \fB4,5,6,7,8,9\fP:
mrr, mtt, mff, mrt, mrf, mtf in 10*exponent dynes-cm
.IP \fB10\fP:
exponent
.IP \fB11,12\fP:
Not used; can be 0 0; allows use of the psmeca file format
.IP \fB13\fP:
Text string to appear above the beach ball (default) or under (add \fBu\fP).
.br
.sp
.TP
OPT(Sx)\fIscale[/fontsize[/offset\fP[\fBu\fP]]]
Principal axis.
\fIscale\fP adjusts the scaling of the radius of the "beach ball", which will
be proportional to the magnitude. The \fIscale\fP is the size for magnitude = 5
(that is seismic scalar moment = 4*10e+23 dynes-cm) in \fBMEASURE_UNIT\fP (unless
\fBc\fP, \fBi\fP, \fBm\fP, or \fBp\fP is appended to indicate that the size
information is in units of cm, inches, meters, or points, respectively).
(\fB-T\fP\fI0\fP option overlays best double couple transparently.) Put
OPT(Sy)\fIscale[/fontsize[/offset\fP[\fBu\fP]]] to plot the only double couple part
of moment tensor.  Put OPT(St)\fIscale[/fontsize[/offset\fP[\fBu\fP]]] to plot
anisotropic part of moment tensor (zero trace).  The color or shade of the
compressive quadrants can be specified with the OPT(G) option.  The color or
shade of the extensive quadrants can be specified with the OPT(E) option.
Parameters are expected to be in the following columns:
.IP \fB1,2\fP:
longitude, latitude of event (OPT(:) option interchanges order)
.IP \fB3\fP:
depth of event in kilometers
.IP \fB4,5,6,7,8,9,10,11,12\fP:
value (in 10*exponent dynes-cm), azimuth, plunge of the T, N, and P axes.
.IP \fB13\fP:
exponent
.IP \fB14,15\fP:
longitude, latitude at which to place beach ball. Entries in these
columns are necessary with the OPT(C) option.  Using 0,0 in columns
9 and 10 will plot the beach ball at the longitude, latitude given in
columns 1 and 2.  The OPT(:) option will interchange the order of
columns (1,2) and (9,10).
.IP \fB16\fP:
Text string to appear above the beach ball (optional).
.br
.TP
OPT(s)\fIsymbol[size[/fontsize[/offset\fP[\fBu\fP]]]
selects a symbol instead of mechanism.
Choose from the following:
(\fBc\fP) circle, (\fBd\fP) diamond, (\fBi\fP) itriangle, (\fBs\fP) square, (\fBt\fP) triangle, (\fBx\fP) cross.
\fIsize\fP is the symbol size in \fBMEASURE_UNIT\fP (unless \fBc\fP, \fBi\fP,
\fBm\fP, or \fBp\fP is appended to indicate that the size information is in
units of cm, inches, meters, or points, respectively).  If \fIsize\fP must be
read, it must be in column 4 and the text string will start in column 5.
Parameters are expected to be in the following columns:
.IP \fB1,2\fP:
longitude, latitude of event (OPT(:) option interchanges order)
.IP \fB3\fP:
depth of event in kilometers
.IP \fB4\fP:
Text string to appear above the beach ball (default) or under (add \fBu\fP).
.br
.SH OPTIONS
No space between the option flag and the associated arguments.
#include "explain_-B_short.txt"
.br
.TP
OPT(E)\fIfill\fP
\fRSelects filling of extensive quadrants. Usually white.
Set the shade (0\-255) or color (r/g/b) [Default is 255/255/255].
.br
.TP
OPT(G)\fIfill\fP
Selects filling of focal mechanisms. By convention, the
compressional quadrants are shaded.  Set the shade (0\-255) or color
(\fIr/g/b\fP) [Default is \fP0/0/0\fP].  Optionally, specify
OPT(Gp)\fIicon_size/pattern\fP, where \fPpattern\fP gives the
number of the image pattern (1-90) OR the name of a Sun rasterfile.
\fPicon_size\fP sets the unit size in inches.  To invert black and
white pixels, use OPT(GP) instead of \fP\-Gp\fP.  See
Appendix E for information on individual patterns.
#include "explain_-H.txt"
#include "explain_-K.txt"
.TP
OPT(L)[\fIpen\fP]
\fRDraws the "beach ball" outline using current pen (see OPT(W)) or sets pen attributes.
.br
.TP
OPT(M)
Same size for any magnitude.
.br
.TP
OPT(N)
\fRDoes \fBNOT \fRskip symbols that fall outside map border [Default plots points inside border only].
#include "explain_-O.txt"
#include "explain_-P.txt"
.br
.TP
OPT(T)[\fInum_of_planes\fP]
\fRPlots the nodal planes and outlines the bubble which is transparent.
If \fInum_of_planes\fP is
.br
      \fI0\fP: both nodal planes are plotted;
      \fI1\fP: only the first nodal plane is plotted;
      \fI2\fP: only the second nodal plane is plotted 
[Default: 0].
#include "explain_-U.txt"
#include "explain_-V.txt"
.br
.TP
OPT(W)
set pen attributes for text string or default pen attributes for fault plane edges. [Defaults: width = \fI1\fP, color = \fP0/0/0\fP, texture = \fPsolid\fP]. 
#include "explain_-XY.txt"
.TP
OPT(Z)cptfile
\fRGive a color palette file and let compressive part color be determined by the z-value in the
third column.
.br
.TP
OPT(a)[\fIsize\fP/[\fIP_axis_symbol\fP/[\fIT_axis_symbol\fP]]]
Computes and plots P and T axes with symbols. Optionally specify \fIsize\fP
and (separate) P and T axis symbols from the following:
(\fBc\fP) circle, (\fBd\fP) diamond, (\fBh\fP) hexagon,
(\fBi\fP) inverse triangle,
(\fBp\fP)point, (\fBs\fP) square, (\fBt\fP) triangle,
(\fBx\fP) cross. [Defaults: 0.2\fBc\fP/\fBc\fP/\fBc\fP or 0.08\fBi\fP/\fBc\fP/\fBc\fP.]
.br
.TP
OPT(e)\fIfill\fP
\fRSelects filling of T axis symbol.
Set the shade (0\-255) or color (r/g/b) [Default is color of extensive parts.] 
.br
.TP
OPT(g)\fIfill\fP
\fRSelects filling of P axis symbol.
Set the shade (0\-255) or color (r/g/b) [Default is color of compressive parts.]
.br
.TP
OPT(p)[\fIpen\fP]
\fRDraws the P axis outline using current pen (see OPT(W)), or sets
pen attributes.
.br
.TP
OPT(t)[\fIpen\fP]
\fRDraws the T axis outline using current pen (see OPT(W)), or sets
pen attributes.
#include "explain_-t.txt"
#include "explain_-c.txt"
.SH "SEE ALSO"
.IR GMT (1),
.IR psbasemap (1),
.IR psmeca (1),
.IR psxy (1)
.sp
.SH REFERENCES
.br
Bomford, G., Geodesy, 4th ed., Oxford University Press, 1980.
.br
Aki, K. and P. Richards, Quantitative Seismology, Freeman, 1980.
.br
F. A. Dahlen and Jeroen Tromp, Theoretical Seismology, Princeton, 1998, p.167.
Definition of scalar moment.
.br
Cliff Frohlich, Cliff's Nodes Concerning Plotting Nodal Lines for P, Sh and Sv\"'
.br
Seismological Research Letters, Volume 67, Number 1, January-February, 1996
.br
Thorne Lay, Terry C. Wallace, Modern Global Seismology, Academic Press, 1995, p.384.
.br
W.H. Press, S.A. Teukolsky, W.T. Vetterling, B.P. Flannery, Numerical Recipes in C, Cambridge University press (routine jacobi)
.br
.sp
.SH AUTHOR
.br
\fRGenevieve Patau
.br
CNRS UMR 7580
.br
Seismology Dept.
.br
Institut de Physique du Globe de Paris
.br
(patau@ipgp.jussieu.fr)
