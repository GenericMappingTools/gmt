#include "common_options.txt"
.TH NEARNEIGHBOR 1 MANDATE GMT_STRING "Generic Mapping Tools"
.SH NAME
nearneighbor \- A "Nearest neighbor" gridding algorithm
.SH SYNOPSIS
\fBnearneighbor\fP [ \fIxyzfile(s)\fP ] OPT(G)\fIout_grdfile\fP GMT_I_OPT  
OPT(N)\fIsectors\fP[/\fImin_sectors\fP] GMT_Rgeo_OPT OPT(S)\fIsearch_radius\fP[\fBm\fP|\fBc\fP|\fBk\fP|\fBK\fP] 
[ OPT(E)\fIempty\fP ] [ OPT(F) ] [ GMT_H_OPT ] [ OPT(L)\fIflag\fP ] [ GMT_V_OPT ] [ OPT(W) ] 
[ GMT_t_OPT ] [ GMT_bi_OPT ] [ GMT_fi_OPT ]
.SH DESCRIPTION
\fBnearneighbor\fP reads arbitrarily located (x,y,z[,w]) triples [quadruplets]
from standard input [or \fIxyzfile(s)\fP] and uses a nearest neighbor algorithm to assign 
an average value to each node that have one or more points within a radius centered on the node.
The average value is computed as a weighted mean of the nearest point from each sector inside the search radius.  The
weighting function used is w(r) = 1 / (1 + d ^ 2), where d = 3 * r / search_radius and r is
distance from the node.  This weight is modulated by the observation points' weights [if supplied].\"'
.TP
\fIxyzfile(s)\fP
3 [or 4, see \fB\-W\fP] column ASCII file(s) [or binary, see \fB\-b\fP] holding (x,y,z[,w]) data values.  If no file is specified, \fBnearneighbor\fP
will read from standard input.
.TP
.B \-G
Give the name of the output grid file.
#include "explain_-I.txt"
.TP
.B \-N
The circular area centered on each node is divided into \fIsectors\fP sectors.  Average values
will only be computed if there is at least one value inside at least \fImin_sectors\fP of the sectors for a
given node.  Nodes that fail this test are assigned the value NaN (but see \fB\-E\fP).
If \fImin_sectors\fP is omitted, each sector needs to have at least one
value inside it.
[Default is quadrant search, i.e., \fIsectors\fP = \fImin_sectors\fP = 4].
Note that only the nearest value per sector enters into the averaging, not all values inside the circle.
#include "explain_-R.txt"
.TP
.B \-S
Sets the \fIsearch_radius\fP in same units as the grid spacing; append \fBm\fP to indicate minutes
or \fBc\fP to indicate seconds.  Append \fBk\fP to indicate km (implies \fB\-R\fP and \fB\-I\fP are in degrees, and
we will use a fast flat Earth approximation to calculate distance).  For more accuracy, use uppercase \fBK\fP
if distances should be calculated along geodesics.
However, if the current \fBELLIPSOID\fP is set to Sphere then spherical great circle calculations are used.
.SH OPTIONS
.TP
.B \-E
Set the value assigned to empty nodes [NaN].
#include "explain_nodereg.txt"
#include "explain_-H.txt"
Not used with binary data.
.TP
.B \-L
Boundary condition \fIflag\fP may be \fIx\fP or \fIy\fP or \fIxy\fP indicating data is periodic in range of 
x or y or both set by \fB\-R\fP, or \fIflag\fP may be \fIg\fP indicating geographical conditions (x and y are 
lon and lat).  [Default is no boundary conditions].
#include "explain_-V.txt"
#include "explain_-t.txt"
.TP
.B \-W
Input data have a 4th column containing observation point weights.  These are multiplied
with the geometrical weight factor to determine the actual weights used in the calculations.
#include "explain_-bi.txt"
[Default is 3 (or 4 if \fB\-W\fP is set) columns].
#include "explain_-f.txt"
#include "explain_float.txt"
.SH EXAMPLES
To create a gridded data set from the file seaMARCII_bathy.lon_lat_z using a 0.5 min grid,
a 5 km search radius, using an octant search, and set empty nodes to -9999:
.sp
\fBnearneighbor\fP seaMARCII_bathy.lon_lat_z \fB\-R\fP242/244/-22/-20 \fB\-I\fP.5\fBm \-E\fP-9999 \fB\-G\fPbathymetry.grd
\fB\-S\fP5k \fB\-N\fP8
.br
.sp
To make a global grid file from the data in geoid.xyz using a 1 degree grid,
a 200 km search radius, spherical distances, using an quadrant search, and set nodes to NaN
only when fewer than two quadrants contain at least one value:
.sp
\fBnearneighbor\fP geoid.xyz \fB\-R\fP0/360/-90/90 \fB\-I\fP1 \fB\-L\fPg \fB\-G\fPgeoid.grd
\fB\-S\fP200K \fB\-N\fP4/2
.SH "SEE ALSO"
.IR blockmean (1),
.IR blockmedian (1),
.IR blockmode (1),
.IR GMT (1),
.IR surface (1),
.IR triangulate (1)
