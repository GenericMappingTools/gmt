
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gravfft &mdash; GMT 6.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=32d919f4" />

  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=9cce70e7"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../_static/copybutton.js?v=f281be69"></script>
        <script>let toggleHintShow = 'Click to show example script';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../../_static/design-tabs.js?v=f930bc37"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="gravprisms" href="gravprisms.html" />
    <link rel="prev" title="gravmag3d" href="gmtgravmag3d.html" />


  <!-- Point to the *latest* version switcher. This will allow the latest versions to appear on older documentation. -->
  <script type="text/javascript" src="/latest/_static/version_switch.js"></script>


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            GMT
          </a>
              <div class="version">
                6.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing GMT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery.html">Illustration Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../animations.html">Animation Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Technical Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules-classic.html">Modules (Classic Mode)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-contrib-symbols.html">Users Symbol Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deprecated-defaults.html">Deprecated GMT Defaults Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../switching.html">Switching between Different Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migrating.html">Migrating from an Earlier Version</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/GenericMappingTools/.github/blob/main/CODE_OF_CONDUCT.md">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/contributing.html">Contributors Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/maintenance.html">Maintainers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/team.html">Team Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/rst-cheatsheet.html">reStructuredText Cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/debug.html">Debugging GMT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/api.html">GMT C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/postscriptlight.html">PostScriptLight C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devdocs/devdocs.html">GMT Enhancement Proposals</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">Getting help</span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://www.generic-mapping-tools.org/"><i class="fa fa-home fa-fw"></i> GMT Homepage</a></li>
            
                <li class="toctree-l1"><a href="https://forum.generic-mapping-tools.org/"><i class="fa fa-comment fa-fw"></i> GMT Community Forum</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/gmt/blob/master/LICENSE.TXT"><i class="fa fa-book fa-fw"></i> License</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/GenericMappingTools/gmt"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
                <li class="toctree-l1"><a href="/dev/gmt-docs-dev.zip"><i class="fa fa-download fa-fw"></i> Documentation HTML zip</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GMT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../modules.html">Modules</a></li>
      <li class="breadcrumb-item active">gravfft</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/GenericMappingTools/gmt/edit/master/doc/rst/source/supplements/potential/gravfft.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <span class="target" id="index-0"></span><section id="gravfft">
<h1>gravfft<a class="headerlink" href="#gravfft" title="Link to this heading"></a></h1>
<p>Spectral calculations of gravity, isostasy, admittance, and coherence for grids</p>
<section id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Link to this heading"></a></h2>
<p><strong>gmt gravfft</strong> <em>ingrid</em> [ <em>ingrid2</em> ]
<a class="reference internal" href="#g"><span><strong>-G</strong></span></a></strong><em>outgrid</em>
[ <a class="reference internal" href="#c"><span><strong>-C</strong></span></a></strong><em>n/wavelength/mean_depth</em>/<strong>t</strong>|<strong>b</strong>|<strong>w</strong> ]
[ <a class="reference internal" href="#d"><span><strong>-D</strong></span></a></strong><em>density</em>|<em>rhogrid</em> ]
[ <a class="reference internal" href="#e"><span><strong>-E</strong></span></a></strong><em>n_terms</em> ]
[ <a class="reference internal" href="#f"><span><strong>-F</strong></span></a></strong>[<strong>f</strong>[<strong>+s</strong>|<strong>z</strong>]|<strong>b</strong>|<strong>g</strong>|<strong>v</strong>|<strong>n</strong>|<strong>e</strong>] ]
[ <a class="reference internal" href="#i"><span><strong>-I</strong></span></a></strong><strong>w</strong>|<strong>b</strong>|<strong>c</strong>|<strong>t</strong>|<strong>k</strong> ]
[ <a class="reference internal" href="#m"><span><strong>-M</strong></span></a></strong><em>mgal_at_45</em> ]
[ <a class="reference internal" href="#n"><span><strong>-N</strong></span></a></strong><em>params</em> ]
[ <a class="reference internal" href="#q"><span><strong>-Q</strong></span></a></strong> ]
[ <a class="reference internal" href="#s"><span><strong>-S</strong></span></a></strong> ]
[ <a class="reference internal" href="#t"><span><strong>-T</strong></span></a></strong><em>te/rl/rm/rw</em>[<em>/ri</em>][<strong>+m</strong>] ]
[ <a class="reference internal" href="#v"><span><strong>-V</strong></span></a></strong>[<em>level</em>] ]
[ <a class="reference internal" href="#w"><span><strong>-W</strong></span></a></strong><em>wd</em>[<strong>k</strong>] ]
[ <a class="reference internal" href="#z"><span><strong>-Z</strong></span></a></strong><em>zm</em>[<em>zl</em>] ]
[ <strong>-f</strong><a class="reference internal" href="../../gmt.html#f-full"><span class="std std-ref">flags</span></a> ]
[ <strong>--PAR</strong>=<em>value</em> ]</p>
<p><strong>Note</strong>: No space is allowed between the option flag and the associated arguments.</p>
</section>
<section id="description">
<h2>Description<a class="headerlink" href="#description" title="Link to this heading"></a></h2>
<p><strong>gravfft</strong> can be used into three main modes. Mode 1: Simply
compute the geopotential due to the surface given in the topo.grd file.
Requires a density contrast (<strong>-D</strong>) and possibly a different observation
level (<strong>-W</strong>).  It will take the 2-D
forward FFT of the grid and
use the full Parker’s method up to the chosen terms.  Mode 2: Compute the
geopotential response due to flexure of the topography file. It will take the 2-D
forward FFT of the grid and use the  full Parker’s method applied to the chosen
isostatic model.  The available
models are the “loading from top”, or elastic plate model, and the
“loading from below” which accounts for the plate’s response to a
sub-surface load (appropriate for hot spot modeling - if you believe
them). In both cases, the model parameters are set with <a class="reference internal" href="#t"><span><strong>-T</strong></span></a></strong> and
<strong>-Z</strong> options. Mode 3: compute the admittance or coherence between
two grids. The output is the average in the radial direction.
Optionally, the model admittance may also be calculated.
Given the number of choices this program offers, is difficult to state
what are options and what are required arguments. It depends on what you
are doing; see the examples for further guidance.</p>
</section>
<section id="required-arguments">
<h2>Required Arguments<a class="headerlink" href="#required-arguments" title="Link to this heading"></a></h2>
<p><em>ingrid</em>[=<em>ID</em>|?<em>varname</em>][<strong>+b</strong><em>band</em>][<strong>+d</strong><em>divisor</em>][<strong>+n</strong><em>invalid</em>][<strong>+o</strong><em>offset</em>][<strong>+s</strong><em>scale</em>]</p>
<blockquote>
<div><p>Optionally, append =<em>ID</em> for reading a specific file
format [Default is =<em>nf</em>] or ?<em>varname</em> for a specific netCDF variable
[Default is the first 2-D grid found by GMT]. The following modifiers are supported:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>+b</strong> - Select a <em>band</em> [Default is 0].</p></li>
<li><p><strong>+d</strong> - Divide data values by the given <em>divisor</em> [Default is 1].</p></li>
<li><p><strong>+n</strong> - Replace data values matching <em>invalid</em> with NaN.</p></li>
<li><p><strong>+o</strong> - Offset data values by the given <em>offset</em> [Default is 0].</p></li>
<li><p><strong>+s</strong> - Scale data values by the given <em>scale</em> [Default is 1].</p></li>
</ul>
</div></blockquote>
<p><strong>Note</strong>: Any offset is added after any scaling.</p>
</div></blockquote>
<span class="target" id="g"></span><p><strong>-G</strong><em>outgrid</em>[=<em>ID</em>][<strong>+d</strong><em>divisor</em>][<strong>+n</strong><em>invalid</em>][<strong>+o</strong><em>offset</em>|<strong>a</strong>][<strong>+s</strong><em>scale</em>|<strong>a</strong>][:<em>driver</em>[<em>dataType</em>][<strong>+c</strong><em>options</em>]]</p>
<blockquote>
<div><p>Optionally, append =<em>ID</em> for writing a specific file format. The following modifiers are supported:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>+d</strong> - Divide data values by given <em>divisor</em> [Default is 1].</p></li>
<li><p><strong>+n</strong> - Replace data values matching <em>invalid</em> with a NaN.</p></li>
<li><p><strong>+o</strong> - Offset data values by the given <em>offset</em>, or append <strong>a</strong> for
automatic range offset to preserve precision for integer grids
[Default is 0].</p></li>
<li><p><strong>+s</strong> - Scale data values by the given <em>scale</em>, or append <strong>a</strong> for
automatic scaling to preserve precision for integer grids [Default
is 1].</p></li>
</ul>
</div></blockquote>
<p><strong>Note</strong>: Any offset is added before any scaling. <strong>+sa</strong> also sets <strong>+oa</strong>
(unless overridden). To write specific formats via GDAL, use =<em>gd</em>
and supply <em>driver</em> (and optionally <em>dataType</em>) and/or one or more
concatenated GDAL <strong>-co</strong> options using <strong>+c</strong>. See
the <a class="reference internal" href="../../reference/features.html#write-grids-images"><span class="std std-ref">“Writing grids and images” cookbook section</span></a>
for more details.</p>
</div></blockquote>
</section>
<section id="optional-arguments">
<h2>Optional Arguments<a class="headerlink" href="#optional-arguments" title="Link to this heading"></a></h2>
<dl class="simple" id="c">
<dt><strong>-C</strong><em>n/wavelength/mean_depth</em>/<strong>t</strong>|<strong>b</strong>|<strong>w</strong></dt><dd><p>Compute only the theoretical admittance curves of the selected model
and exit. <em>n</em> and <em>wavelength</em> are used to compute (n * wavelength)
the total profile length in meters. <em>mean_depth</em> is the mean water
depth. Append data flags (one or two) of <strong>t</strong>|<strong>b</strong>|<strong>w</strong> in any order.
Here, <em>t</em> = use “from top” model, <em>b</em> = use “from below” model. Optionally
specify <em>w</em> to write wavelength instead of frequency.</p>
</dd>
</dl>
<dl class="simple" id="d">
<dt><strong>-D</strong><em>density</em>|<em>rhogrid</em></dt><dd><p>Sets density contrast across surface. Used, for example, to compute
the gravity attraction of the water layer that can later be combined
with the free-air anomaly to get the Bouguer anomaly. In this case
do not use <a class="reference internal" href="#t"><span><strong>-T</strong></span></a></strong>. It also implicitly sets <strong>-N+h</strong>.  Alternatively,
specify a co-registered grid with density contrasts if a variable
density contrast is required.  <strong>Note</strong>: Any NaNs found in the density
grid will be replaced with the minimum density found.</p>
</dd>
</dl>
<dl class="simple" id="e">
<dt><strong>-E</strong><em>n_terms</em></dt><dd><p>Number of terms used in Parker expansion (limit is 10, otherwise
terms depending on n will blow out the program) [Default = 3].</p>
</dd>
</dl>
<dl id="f">
<dt><strong>-F</strong>[<strong>f</strong>[<strong>+s</strong>|<strong>z</strong>]|<strong>b</strong>|<strong>g</strong>|<strong>v</strong>|<strong>n</strong>|<strong>e</strong>]</dt><dd><p>Specify desired geopotential field: compute geoid rather than gravity</p>
<blockquote>
<div><p><strong>f</strong> = Free-air anomalies (mGal) [Default].  Append <strong>+s</strong> to add
in the slab implied when removing the mean value from the topography.
This requires zero topography to mean no mass anomaly. Alternatively,
to force the far-field to be exactly zero (i.e., the corner nodes of
the grid), select <strong>+z</strong> instead.</p>
<p><strong>b</strong> = Bouguer gravity anomalies (mGal).</p>
<p><strong>g</strong> = Geoid anomalies (m).</p>
<p><strong>v</strong> = Vertical Gravity Gradient (VGG; 1 Eotvos = 0.1 mGal/km).</p>
<p><strong>e</strong> = East deflections of the vertical (micro-radian).</p>
<p><strong>n</strong> = North deflections of the vertical (micro-radian).</p>
</div></blockquote>
</dd>
</dl>
<dl class="simple" id="i">
<dt><strong>-I</strong><strong>w</strong>|<strong>b</strong>|<strong>c</strong>|<strong>t</strong>|<strong>k</strong></dt><dd><p>Use <em>ingrid2</em> and <em>ingrid1</em> (a grid with topography/bathymetry) to estimate admittance|coherence and
write it to standard output (<strong>-G</strong> ignored if set). This grid should contain
gravity or geoid for the same region of <em>ingrid1</em>. Default
computes admittance. Output contains 3 or 4 columns. Frequency
(wavelength), admittance (coherence) one sigma error bar and,
optionally, a theoretical admittance. Append dataflags (one to
three) from <strong>w</strong>|<strong>b</strong>|<strong>c</strong>|<strong>t</strong>.
<strong>w</strong> writes wavelength instead of wavenumber, <strong>k</strong>
selects km for wavelength unit [m], <strong>c</strong> computes coherence instead of
admittance, <strong>b</strong> writes a fourth column with “loading from below”
theoretical admittance, and <strong>t</strong> writes a fourth column with “elastic
plate” theoretical admittance.</p>
</dd>
</dl>
<dl class="simple" id="m">
<dt><strong>-M</strong><em>mgal_at_45</em></dt><dd><p>Specify the value of the gravity in mili Gals at 45 degrees latitude (used to convert
gravity anomalies to geoid heights). Default is 980619.9203 mGal (Moritz’s 1980 IGF value).
This value needs to be changed accordingly when using data from other planets.</p>
</dd>
</dl>
<dl id="n">
<dt><strong>-N</strong>[<strong>a</strong>|<strong>f</strong>|<strong>m</strong>|<strong>r</strong>|<strong>s</strong>|<em>nx/ny</em>][<strong>+a</strong>|<strong>d</strong>|<strong>h</strong>|<strong>l</strong>][<strong>+e</strong>|<strong>n</strong>|<strong>m</strong>][<strong>+t</strong><em>width</em>][<strong>+v</strong>][<strong>+w</strong>[<em>suffix</em>]][<strong>+z</strong>[<strong>p</strong>]]</dt><dd><p>Choose or inquire about suitable grid dimensions for FFT and set
optional parameters. Control the FFT dimension via these directives:</p>
<ul class="simple">
<li><p><strong>a</strong> - Let the FFT select dimensions yielding the most accurate result.</p></li>
<li><p><strong>f</strong> - Force the FFT to use the actual dimensions of the data.</p></li>
<li><p><strong>m</strong> - Let the FFT select dimensions using the least work memory.</p></li>
<li><p><strong>r</strong> - Let the FFT select dimensions yielding the most rapid calculation.</p></li>
<li><p><strong>s</strong> - Just present a list of optional dimensions, then exit.</p></li>
</ul>
<p>Without a directive we expect <strong>-N</strong><em>nx/ny</em> which will do FFT on array size <em>nx/ny</em>
(must be &gt;= grid file size). Default chooses dimensions &gt;= data which optimize speed
and accuracy of FFT. If FFT dimensions &gt; grid file dimensions, data are extended and
tapered to zero.</p>
<p>Control detrending of data by appending a modifier for removing a linear trend.
Consult module documentation for the default action:</p>
<ul class="simple">
<li><p><strong>+d</strong> - Detrend data, i.e. remove best-fitting linear trend.</p></li>
<li><p><strong>+a</strong> - Only remove the mean value.</p></li>
<li><p><strong>+h</strong> - Only remove the mid value, i.e. 0.5 * (max + min).</p></li>
<li><p><strong>+l</strong> - Leave data alone.</p></li>
</ul>
<p>Control extension and tapering of data by appending a modifier to control how
the extension and tapering are to be performed:</p>
<ul class="simple">
<li><p><strong>+e</strong> - Extend the grid by imposing edge-point symmetry [Default].</p></li>
<li><p><strong>+m</strong> - Extends the grid by imposing edge mirror symmetry.</p></li>
<li><p><strong>+n</strong> - Turns off data extension.</p></li>
</ul>
<p>Tapering is performed from the data edge to the FFT grid edge [100%].
Change this percentage via modifier <strong>+t</strong><em>width</em>. When <strong>+n</strong> is in effect,
the tapering is applied instead to the data margins as no extension is
available [0%].</p>
<p>Control messages being reported:</p>
<ul class="simple">
<li><p><strong>+v</strong> - Report suitable dimensions during processing.</p></li>
</ul>
<p>Control writing of temporary results:
For detailed investigation you can write the intermediate grid being passed
to the forward FFT; this is likely to have been detrended, extended by
point-symmetry along all edges, and tapered. Use these modifiers to ave such grids:</p>
<ul class="simple">
<li><p><strong>+w</strong> - Set the <em>suffix</em> from which output file name(s) will be created
(i.e., <em>ingrid_prefix.ext</em>) [Default is “tapered”], where <em>ext</em> is your file extension</p></li>
<li><p><strong>+z</strong> -  Save the complex grid produced by the forward FFT. By default we
write the real and imaginary components to <em>ingrid</em>_real.<em>ext</em> and
<em>ingrid</em>_imag.<em>ext</em>.  Append <strong>p</strong> to instead use the polar form of magnitude
and phase to files <em>ingrid</em>_mag.<em>ext</em> and <em>ingrid</em>_phase.<em>ext</em>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="q">
<dt><strong>-Q</strong></dt><dd><p>Writes out a grid with the flexural topography (with z positive up)
whose average depth was set by <strong>-Z</strong><em>zm</em> and model parameters by <a class="reference internal" href="#t"><span><strong>-T</strong></span></a></strong>
(and output by <a class="reference internal" href="#g"><span><strong>-G</strong></span></a></strong>). That is the “gravimetric Moho”. <a class="reference internal" href="#q"><span><strong>-Q</strong></span></a></strong>
implicitly sets <strong>-N+h</strong>.</p>
</dd>
</dl>
<dl class="simple" id="s">
<dt><strong>-S</strong></dt><dd><p>Computes predicted gravity or geoid grid due to a subplate load
produced by the current bathymetry and the theoretical model. The
necessary parameters are set within <a class="reference internal" href="#t"><span><strong>-T</strong></span></a></strong> and <a class="reference internal" href="#z"><span><strong>-Z</strong></span></a></strong> options. The
number of powers in Parker expansion is restricted to 1.
See an example further down.</p>
</dd>
</dl>
<dl class="simple" id="t">
<dt><strong>-T</strong><em>te/rl/rm/rw</em>[<em>/ri</em>][<strong>+m</strong>]</dt><dd><p>Compute the isostatic compensation from the topography load (input grid file) on
an elastic plate of thickness <em>te</em>. Also append densities for load, mantle,
water and infill in SI units. If <em>ri</em> is not provided it defaults to <em>rl</em>.
Give average mantle depth via <a class="reference internal" href="#z"><span><strong>-Z</strong></span></a></strong>. If the elastic thickness
is &gt; 1e10 it will be interpreted as the flexural rigidity (by default it is
computed from <em>te</em> and Young modulus). Optionally, append <em>+m</em> to write a grid
with the Moho’s geopotential effect (see <a class="reference internal" href="#f"><span><strong>-F</strong></span></a></strong>) from model selected by <a class="reference internal" href="#t"><span><strong>-T</strong></span></a></strong>.
If <em>te</em> = 0 then the Airy response is returned. <strong>-T+m</strong> implicitly sets <strong>-N+h</strong>.</p>
</dd>
</dl>
<dl class="simple" id="w">
<dt><strong>-W</strong><em>wd</em>[<strong>k</strong>]</dt><dd><p>Set water depth (or observation height) relative to topography in meters [0].  Append <strong>k</strong> to indicate km.</p>
</dd>
</dl>
<dl class="simple" id="z">
<dt><strong>-Z</strong><em>zm</em>[/<em>zl</em>]</dt><dd><p>Moho [and swell] average compensation depths (in meters positive down – the depth). For the “load from
top” model you only have to provide <em>zm</em>, but for the “loading from below” don’t forget to supply <em>zl</em>.</p>
</dd>
</dl>
<dl class="simple" id="v">
<dt><strong>-V</strong>[<em>level</em>]</dt><dd><p>Select verbosity level [<strong>w</strong>]. <a class="reference internal" href="../../gmt.html#v-full"><span class="std std-ref">(See full description)</span></a> <a class="reference internal" href="../../reference/options.html#verbose-feedback-the-v-option"><span class="std std-ref">(See technical reference)</span></a>.</p>
</dd>
</dl>
<dl class="simple">
<dt><strong>-f</strong><a class="reference internal" href="../../gmt.html#f-full"><span class="std std-ref">flags</span></a></dt><dd><p>Geographic grids (dimensions of longitude, latitude) will be converted to
meters via a “Flat Earth” approximation using the current ellipsoid parameters.</p>
</dd>
</dl>
<dl class="simple">
<dt><strong>-^</strong> or just <strong>-</strong></dt><dd><p>Print a short message about the syntax of the command, then exit (<strong>Note</strong>: on Windows just use <strong>-</strong>).</p>
</dd>
<dt><strong>-+</strong> or just <strong>+</strong></dt><dd><p>Print an extensive usage (help) message, including the explanation of
any module-specific option (but not the GMT common options), then exit.</p>
</dd>
<dt><strong>-?</strong> or no arguments</dt><dd><p>Print a complete usage (help) message, including the explanation of all options, then exit.</p>
</dd>
<dt><strong>--PAR</strong>=<em>value</em></dt><dd><p>Temporarily override a GMT default setting; repeatable. See <a class="reference internal" href="../../gmt.conf.html"><span class="doc">gmt.conf</span></a> for parameters.</p>
</dd>
</dl>
</section>
<section id="grid-distance-units">
<h2>Grid Distance Units<a class="headerlink" href="#grid-distance-units" title="Link to this heading"></a></h2>
<p>If the grid does not have meter as the horizontal unit, append <strong>+u</strong><em>unit</em>
to the input file name to convert from the specified unit to meter.  If your
grid is geographic, convert distances to meters by supplying <strong>-f</strong><a class="reference internal" href="../../gmt.html#f-full"><span class="std std-ref">flags</span></a> instead.</p>
</section>
<section id="considerations">
<h2>Considerations<a class="headerlink" href="#considerations" title="Link to this heading"></a></h2>
<p>netCDF COARDS grids will automatically be recognized as geographic. For
other grids geographical grids were you want to convert degrees into
meters, select <strong>-f</strong><a class="reference internal" href="../../gmt.html#f-full"><span class="std std-ref">flags</span></a>. If the data are close to either pole, you should
consider projecting the grid file onto a rectangular coordinate system
using <a class="reference internal" href="../../grdproject.html"><span class="doc">grdproject</span></a>.</p>
</section>
<section id="handling-of-grids-with-nans">
<h2>Handling of Grids with NaNs<a class="headerlink" href="#handling-of-grids-with-nans" title="Link to this heading"></a></h2>
<p>Since we cannot take FFTs of 2-D grids that contain NaNs, we perform simple substitutions.
If any of the input grids contain NaNs they will be replaced with zeros. In contrast, if <strong>-D</strong>
passes a grid with density contrasts then we replace any NaNs with the minimum density in the grid.</p>
</section>
<section id="data-detrending">
<h2>Data Detrending<a class="headerlink" href="#data-detrending" title="Link to this heading"></a></h2>
<p>The default detrending mode follows Parker [1972] and removes the mid-value (<strong>+h</strong>).
Consult and use <a class="reference internal" href="#n"><span><strong>-N</strong></span></a></strong> to select other modes.</p>
</section>
<section id="plate-flexure">
<h2>Plate Flexure<a class="headerlink" href="#plate-flexure" title="Link to this heading"></a></h2>
<p>The FFT solution to elastic plate flexure requires the infill density to equal
the load density.  This is typically only true directly beneath the load; beyond the load
the infill tends to be lower-density sediments or even water (or air).  Wessel [2001]
proposed an approximation that allows for the specification of an infill density
different from the load density while still allowing for an FFT solution. Basically,
the plate flexure is solved for using the infill density as the effective load density but
the amplitudes are adjusted by a factor <em>A</em> = sqrt ((rm - ri)/(rm - rl)), which is
the theoretical difference in amplitude due to a point load using the two different
load densities.  The approximation is very good but breaks down for large
loads on weak plates, a fairy uncommon situation.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<p>To compute the effect of the water layer above the bat.grd bathymetry
using 2700 and 1035 for the densities of crust and water and writing the
result on water_g.grd (computing up to the fourth power of bathymetry
in Parker expansion):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>bat.grd<span class="w"> </span>-D1665<span class="w"> </span>-Gwater_g.grd<span class="w"> </span>-E4
</pre></div>
</div>
<p>Now subtract it from your free-air anomaly faa.grd and you will get the
Bouguer anomaly. You may wonder why we are subtracting and not adding.
After all the Bouguer anomaly pretends to correct the mass deficiency
presented by the water layer, so we should add because water is less
dense than the rocks below. The answer relies on the way gravity
effects are computed by the Parker’s method and practical aspects of
using the FFT.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>grdmath<span class="w"> </span>faa.grd<span class="w"> </span>water_g.grd<span class="w"> </span><span class="nv">SUB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>bouguer.grd
</pre></div>
</div>
<p>Want an MBA anomaly? Well compute the crust mantle contribution and add
it to the sea-bottom anomaly. Assuming a 6 km thick crust of density
2700 and a mantle with 3300 density we could repeat the command used to
compute the water layer anomaly, using 600 (3300 - 2700) as the density
contrast. But we now have a problem because we need to know the mean
Moho depth. That is when the scale/offset that can be appended to the grid’s name
comes in hand. Notice that we didn’t need to do that before because mean water
depth was computed directly from data (notice also the negative sign of the
offset due to the fact that <em>z</em> is positive up):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>bat.grd+o-6000<span class="w"> </span>-D600<span class="w"> </span>-Gmoho_g.grd
</pre></div>
</div>
<p>Now, subtract it from the Bouguer to obtain the MBA anomaly. That is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>grdmath<span class="w"> </span>bouguer.grd<span class="w"> </span>moho_g.grd<span class="w"> </span><span class="nv">SUB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>mba.grd
</pre></div>
</div>
<p>To compute the Moho gravity effect of an elastic plate bat.grd with Te =
7 km, density of 2700, over a mantle of density 3300, at an average depth
of 9 km</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>bat.grd<span class="w"> </span>-Gelastic.grd<span class="w"> </span>-T7000/2700/3300/1035+m<span class="w"> </span>-Z9000
</pre></div>
</div>
<p>If you add now the sea-bottom and Moho’s effects, you will get the full
gravity response of your isostatic model. We will use here only the
first term in Parker expansion.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>bat.grd<span class="w"> </span>-D1665<span class="w"> </span>-Gwater_g.grd<span class="w"> </span>-E1
gmt<span class="w"> </span>gravfft<span class="w"> </span>bat.grd<span class="w"> </span>-Gelastic.grd<span class="w"> </span>-T7000/2700/3300/1035+m<span class="w"> </span>-Z9000<span class="w"> </span>-E1
gmt<span class="w"> </span>grdmath<span class="w"> </span>water_g.grd<span class="w"> </span>elastic.grd<span class="w"> </span><span class="nv">ADD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>model.grd
</pre></div>
</div>
<p>The same result can be obtained directly by the next command. However,
PAY ATTENTION to the following. I don’t yet know if it’s because of a
bug or due to some limitation, but the fact is that the following and
the previous commands only give the same result if <strong>-E</strong>1 is used.
For higher powers of bathymetry in Parker expansion,
only the above example seams to give the correct result.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>bat.grd<span class="w"> </span>-Gmodel.grd<span class="w"> </span>-T7000/2700/3300/1035<span class="w"> </span>-Z9000<span class="w"> </span>-E1
</pre></div>
</div>
<p>And what would be the geoid anomaly produced by a load at 50 km depth,
below a region whose bathymetry is given by bat.grd, a Moho at 9 km
depth and the same densities as before?</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>topo.grd<span class="w"> </span>-Gswell_geoid.grd<span class="w"> </span>-T7000/2700/3300/1035<span class="w"> </span>-Fg<span class="w"> </span>-Z9000/50000<span class="w"> </span>-S<span class="w"> </span>-E1
</pre></div>
</div>
<p>To compute the admittance between the topo.grd bathymetry and faa.grd
free-air anomaly grid using the elastic plate model of a crust of 6 km
mean thickness with 10 km effective elastic thickness in a region of 3 km
mean water depth:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>topo.grd<span class="w"> </span>faa.grd<span class="w"> </span>-It<span class="w"> </span>-T10000/2700/3300/1035<span class="w"> </span>-Z9000
</pre></div>
</div>
<p>To compute the admittance between the topo.grd bathymetry and geoid.grd
geoid grid with the “loading from below” (LFB) model with the same as
above and sub-surface load at 40 km, but assuming now the grids are in
geographic and we want wavelengths instead of frequency:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>topo.grd<span class="w"> </span>geoid.grd<span class="w"> </span>-Ibw<span class="w"> </span>-T10000/2700/3300/1035<span class="w"> </span>-Z9000/40000<span class="w"> </span>-fg
</pre></div>
</div>
<p>To compute the gravity theoretical admittance of a LFB along a 2000 km
long profile using the same parameters as above</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmt<span class="w"> </span>gravfft<span class="w"> </span>-C400/5000/3000/b<span class="w"> </span>-T10000/2700/3300/1035<span class="w"> </span>-Z9000/40000
</pre></div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<p>Luis, J.F. and M.C. Neves. 2006, The isostatic compensation of the
Azores Plateau: a 3D admittance and coherence analysis. J. Geothermal
Volc. Res. Volume 156, Issues 1-2, Pages 10–22,
<a class="reference external" href="https://doi.org/10.1016/j.jvolgeores.2006.03.010">https://doi.org/10.1016/j.jvolgeores.2006.03.010</a></p>
<p>Parker, R. L., 1972, The rapid calculation of potential anomalies, Geophys. J., 31, 447–455.</p>
<p>Wessel. P., 2001, Global distribution of seamounts inferred from gridded Geosat/ERS-1 altimetry,
J. Geophys. Res., 106(B9), 19,431–19,441,
<a class="reference external" href="https://doi.org/10.1029/2000JB000083">https://doi.org/10.1029/2000JB000083</a></p>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading"></a></h2>
<p><a class="reference internal" href="../../gmt.html"><span class="doc">gmt</span></a>, <a class="reference internal" href="../../grdfft.html"><span class="doc">grdfft</span></a>,
<a class="reference internal" href="../../grdmath.html"><span class="doc">grdmath</span></a>, <a class="reference internal" href="../../grdproject.html"><span class="doc">grdproject</span></a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gmtgravmag3d.html" class="btn btn-neutral float-left" title="gravmag3d" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gravprisms.html" class="btn btn-neutral float-right" title="gravprisms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, The GMT Team.
      <span class="lastupdated">Last updated on Oct 12, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>